<html>
  <head>
    <title>Canonicalization</title>
  </head>
  <body>
    <h1><hr>Canonicalization</h1>

    <p>
      {{ v.ballot.voter.name }} ({{ v.ballot.year }}):
      {{ v.category }} {{ v.rank }}.
      {% include "vote-view.html" %}<br>
      {% if v.release %}
	Current canonicalization:
	<strong>{{ v.release.artist.name }}</strong>,
	<cite>{{ v.release.title }}</cite><br>
      {% endif %}
      {% for a in artists %}
	<form action="" method="get">
	  <input type="submit" value="Use this artist">
	  <input type="hidden" name="artist.id" value="{{ a.key.id }}">
	  <strong>{{ a.name|escape }}</strong>
	</form>
      {% endfor %}
      {% for r in releases %}
	<form action="" method="post">
	  <input type="submit" value="Use this release">
	  <input type="hidden" name="release.id" value="{{ r.key.id }}">
	  <strong>{{ r.artist.name|escape }}</strong>,
	  <cite>{{ r.title|escape }}</cite>
	</form>
	<br>
      {% endfor %}
      <form action="" method="post">
	<table>
	  <tr>
	    <td rowspan="5"><input type="submit" value="New release"></td>
	    <td rowspan="3">Artist</td>
	    {% if artist %}
	      <td rowspan="3" colspan="2">
		<strong>{{ artist.name }}</strong>
		<input type="hidden" value="{{ artist.id }}"
		       name="artist.{% if mbArtist %}mb{% endif %}id">
	      </td>
	    {% else %}
	      <td><label for="artist">Name</label></td>
	      <td><input name="artist" value="{{ artistName }}"></td>
	    {% endif %}
	    <td rowspan="5">
	      <a href="http://google.com/search?q={{ artistName }}+{{ v.title }}"
		 target="_blank">Search Google</a>
	    </td>
	  </tr>
	  <tr>
	    {% if not artist %}
	      <td><label for="sortname">Sortname</label></td>
	      <td><input name="sortname" value="{{ artistName }}"></td>
	    {% endif %}
	  </tr>
	  <tr>
	    {% if not artist %}
	      <td><label for="artisturl">URL</label></td>
	      <td><input name="artisturl" size="40"></td>
	    {% endif %}
	  </tr>
	  <tr>
	    <td rowspan="2">Release</td>
	    <td><label for="title">Title</label></td>
	    <td><input name="title" value="{{ v.title }}"size="40"></td>
	  </tr>
	  <tr>
	    <td><label for="releaseurl">URL</label></td>
	    <td><input name="releaseurl" size="40"></td>
	  </tr>
	</table>
      </form>
      <br>
      <form action="" method="get">
	<input type="submit" value="Search">
	<input name="artistName" value="{{ artistName }}">
      </form>
      <br>
      {% for a in mbArtists %}
	<form action="" method="get">
	  <input type="submit" value="Use this artist">
	  <input type="hidden" name="artist.mbid" value="{{ a.id }}">
	  {{ a.score }}%
	  <a href="http://musicbrainz.org/artist/{{ a.id }}.html">
	    <strong>{{ a.name|escape }}</strong></a>
	    {% if a.disambiguation %}
	      [{{ a.disambiguation|escape }}]
	    {% endif %}
	</form>
      {% endfor %}
      {% for r in rgs %}
	<form action="" method="post">
	  <input type="submit" value="Use this release">
	  <input type="hidden" name="release.mbid" value="{{ r.id }}">
	  {{ r.score }}%
	  <a href="http://musicbrainz.org/artist/{{ r.artist.id }}.html">
	    <strong>{{ r.artist.name|escape }}</strong></a>,
	  <a href="http://musicbrainz.org/release-group/{{ r.id }}.html">
	    <cite>{{ r.title|escape }}</cite>
	    {{ r.type }}
	  </a>
	</form>
      {% endfor %}
  </body>
</html>
